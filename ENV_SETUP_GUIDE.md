# Environment Configuration Guide - Backend

This guide explains how to set up environment variables for the Coopvest Africa backend (Laravel).

## Quick Setup

### Automated Setup (Recommended)

Run the setup script to automatically create a `.env` file with development defaults:

```bash
bash setup-env.sh
```

This will:
1. Copy `.env.example` to `.env`
2. Generate a random `APP_KEY` for Laravel
3. Fill in development defaults for Firebase
4. Configure CORS for local development

### Manual Setup

1. Copy the example file:
```bash
cp .env.example .env
```

2. Generate an application key:
```bash
php artisan key:generate
```

3. Edit `.env` and update the following variables with your actual values

## Required Environment Variables

### Application Configuration
- `APP_NAME` - Application name (default: "Coopvest Africa")
- `APP_ENV` - Environment (local/production)
- `APP_KEY` - Laravel encryption key (generated by `php artisan key:generate`)
- `APP_DEBUG` - Debug mode (true/false)
- `APP_URL` - Application URL (default: `http://localhost:8000`)

### Database Configuration
- `DB_CONNECTION` - Database type (mysql/postgresql)
- `DB_HOST` - Database host
- `DB_PORT` - Database port
- `DB_DATABASE` - Database name
- `DB_USERNAME` - Database username
- `DB_PASSWORD` - Database password

### Firebase Configuration
- `FIREBASE_PROJECT_ID` - Firebase project ID
- `FIREBASE_API_KEY` - Firebase API key
- `FIREBASE_AUTH_DOMAIN` - Firebase auth domain
- `FIREBASE_DATABASE_URL` - Firebase database URL
- `FIREBASE_STORAGE_BUCKET` - Firebase storage bucket
- `FIREBASE_MESSAGING_SENDER_ID` - Firebase messaging sender ID
- `FIREBASE_APP_ID` - Firebase app ID
- `FIREBASE_MEASUREMENT_ID` - Firebase measurement ID

### Firebase Admin SDK Settings
- `FIREBASE_ADMIN_SDK_ENABLED` - Enable Firebase Admin SDK (true/false)
- `FIREBASE_VERIFY_ID_TOKEN` - Verify ID tokens (true/false)
- `FIREBASE_CACHE_TOKENS` - Cache tokens (true/false)
- `FIREBASE_TOKEN_CACHE_TTL` - Token cache TTL in seconds

### CORS Configuration
- `FRONTEND_URL` - Frontend URL for CORS (default: `http://localhost:5173`)
- `SANCTUM_STATEFUL_DOMAINS` - Stateful domains for Sanctum

### Optional Configuration
- `MAIL_MAILER` - Mail driver (log/smtp)
- `REDIS_HOST` - Redis host
- `REDIS_PORT` - Redis port
- `CACHE_DRIVER` - Cache driver (file/redis)

## Development vs Production

### Development
```env
APP_ENV=local
APP_DEBUG=true
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_DATABASE=coopvest_africa
FRONTEND_URL=http://localhost:5173
FIREBASE_ADMIN_SDK_ENABLED=true
```

### Production
```env
APP_ENV=production
APP_DEBUG=false
DB_CONNECTION=postgresql
DB_HOST=your-db-host.com
DB_DATABASE=coopvest_africa_prod
FRONTEND_URL=https://your-frontend.com
FIREBASE_ADMIN_SDK_ENABLED=true
```

## Database Setup

### MySQL (Development)
```bash
# Create database
mysql -u root -p -e "CREATE DATABASE coopvest_africa;"

# Run migrations
php artisan migrate

# Seed data (optional)
php artisan db:seed
```

### PostgreSQL (Production)
```bash
# Create database
createdb coopvest_africa

# Run migrations
php artisan migrate

# Seed data (optional)
php artisan db:seed
```

## Security Notes

⚠️ **Important:**
- Never commit `.env` files to version control
- `.env` is in `.gitignore` for security
- Always use strong, random values for `APP_KEY` (generated automatically)
- Use environment-specific values for each deployment
- Rotate secrets regularly
- Use HTTPS in production

## Firebase Setup

1. Go to [Firebase Console](https://console.firebase.google.com)
2. Create a new project or select existing one
3. Go to Project Settings
4. Under "Your apps", click on the web app
5. Copy the configuration values to your `.env` file
6. Download Firebase Admin SDK credentials (if using Admin SDK)

## Troubleshooting

### "No application encryption key has been specified"
```bash
php artisan key:generate
```

### Database connection errors
- Verify `DB_HOST`, `DB_USERNAME`, `DB_PASSWORD` are correct
- Ensure database server is running
- Check database exists: `php artisan migrate --step`

### Firebase authentication errors
- Verify Firebase credentials are correct
- Check `FIREBASE_PROJECT_ID` matches your Firebase project
- Ensure Firebase Admin SDK credentials are properly configured

## Next Steps

After setting up `.env`:

```bash
composer install
php artisan migrate
php artisan serve
```

The API will be available at `http://localhost:8000`

## API Documentation

See `API_DOCUMENTATION.md` for endpoint documentation and usage examples.
